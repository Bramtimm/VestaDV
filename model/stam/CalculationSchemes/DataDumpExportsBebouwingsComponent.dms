//////////////////////////////////////////////////////////////////////////////////////////
//                                                                                      //
//                   (C) VESTA 2019 - Planbureau voor de Leefomgeving                   //
//                                                                                      //
//////////////////////////////////////////////////////////////////////////////////////////
template DataDumpExportsBebouwingsComponent
{
	//begin of case parameters
	parameter<String> ComponentName;
	container AllocatieComponent;    //voorbeeld TussenResultaten/R1_2020/AllocatieResultaten/BestaandeWoning 
	container BebouwingsComponenten; //voorbeeld TussenResultaten/R1_2020/BebouwingsComponenten/BestaandeWoning 
	//end of case parameters

	container BCdata                    := AllocatieComponent/BCdata;
	container RuimtelijkeVraagComponent := AllocatieComponent/RuimtelijkeVraagComponent;

	unit<UInt32>  table := AllocatieComponent/BebouwingsObject
	{
		attribute<string> id                                	:= code;
		attribute<Geography/rdc_grids/m100> gridm100_rel    	:= BebouwingsComponenten/RuimtelijkeVraagComponent/gridm100_rel;
		attribute<rdc_meter> geometry                       	:=Geography/rdc_grids/m100/point[gridm100_rel];

		//attribute<Geography/RegioIndelingen/buurt> buurt_rel := /Invoer/RuimtelijkeData/BAG/vbo_woonfunctie_studiegebied/Buurt_rel;
		attribute<string> BU_CODE                           	:= Invoer/RuimtelijkeData/StudieGebied/buurt/BU_CODE[Invoer/RuimtelijkeData/BAG/vbo_woonfunctie_studiegebied/Buurt_rel];//buurtcode

		attribute<float64> PointRowXY := PointRow(geometry);
		attribute<float64> PointColXY := PointCol(geometry);

		attribute<nrAansl> nrAansluitingen := RuimtelijkeVraagComponent/nrAansluitingen;									//aantal woningequivalenten

		attribute<Classifications/WarmteOptie>  Warmteoptie 	:= AllocatieComponent/WarmteAllocatie;
		
		attribute<classifications/EnergieLabel> Elabel      	:= BCdata/energielabel/CurrValue;

		attribute<GJ_yr> MV_totaal                          	:= AllocatieComponent/Metervraag/totaal;					//metervraag warmte totaal
		attribute<GJ_yr> MV_Aardgas                         	:= AllocatieComponent/Metervraag/Aardgas;					//metervraag aardgas
		attribute<GJ_yr> MV_ELEK                            	:= AllocatieComponent/Metervraag/Elektriciteit;				//metervraag aardgas
		
		attribute<GJ_yr> MV_WarmteMT                        	:= AllocatieComponent/Metervraag/WarmteMT;					//metervraag MT warmtelevering
		attribute<GJ_yr> MV_WarmteLT                        	:= AllocatieComponent/Metervraag/WarmteLT;					// metervraag LT warmtelevering
		attribute<GJ_yr> MV_eWP                             	:= AllocatieComponent/Metervraag/eWP;						//metervraag elektriciteit eWP

		//onduidelijk welke
		attribute<GJ_yr> FV_Koude                           	:= BebouwingsComponenten/Functioneel/Koude;
		attribute<GJ_yr> FV_Koude2                          	:= RuimtelijkeVraagComponent/Functioneel/Koude;

		attribute<KG_yr> CO2_GAS                            	:= AllocatieComponent/CO2/AardGas;
		attribute<KG_yr> CO2_ELEK                           	:= AllocatieComponent/CO2/Elektriciteit;
		attribute<KG_yr> CO2                                	:= CO2_GAS + CO2_ELEK;
	}
	
	unit<uint32> variable := SubItem_PropValues(table,'name');
	container export_csv := Rapportage/WriteTable32ToCSV(table, AsList(variable/name, ';'), FolderInfo/OutputFolder+'/'+ComponentName+'.csv');
}