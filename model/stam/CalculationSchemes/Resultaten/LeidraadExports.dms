container LeidraadExports: = Units, isHidden = "True"
{
	container GemeenteRapport
	{
// 	container PlanRegioResults
// 	{
// 		container PlanRegioKaarten := TussenResultaten/GebiedsAllocatie/Initieel/KostenBaten/PlanRegioKaarten;

// 		Unit<UInt32>  table := Invoer/SpecifiekeInstellingen/PlanRegio
// 		{
// 			attribute<string> BU_CODE                                       := Geography/RegioIndelingen/buurt/BU_CODE;
// 			attribute<Classifications/AanbodOptie> AanbodOptie              := StateNaAllocatie/AanbodOpties/PlanRegioWarmteAllocatie;

// 			attribute<units/kg_yr> CO2_gebouwen_AardGas_totaal              := CO2/gebouwen/AardGas/totaal;
// 			attribute<units/kg_yr> CO2_gebouwen_Elektriciteit_totaal        := CO2/gebouwen/Elektriciteit/totaal;
// 			attribute<units/kg_yr> CO2_gebouwen_totaal                      := CO2/gebouwen/totaal;
// 			attribute<units/kg_yr> CO2_totaal                               := CO2/totaal;
// 			attribute<units/Eur_yr> netverzwaring                           := netwerken/Elektriciteit/netverzwaring;

// 			attribute<units/kW>      Woning_CapaciteitWarmteDeelnemers      := PlanRegioKaarten/BestaandeWoning/CapaciteitWarmteDeelnemers;
// 			attribute<units/nrAansl> Woning_nrAanslWarmteDeelnemers         := PlanRegioKaarten/BestaandeWoning/nrAanslWarmteDeelnemers;
// 			attribute<float64>       Woning_nrModelUnitsWarmteDeelnemers    := PlanRegioKaarten/BestaandeWoning/nrModelUnitsWarmteDeelnemers;
// 			attribute<units/GJ_yr>   Woning_VerbruikAalle                   := PlanRegioKaarten/BestaandeWoning/Verbruik/alle;
// 			attribute<units/Eur_yr>  Woning_WarmteVraagAlle                 := PlanRegioKaarten/BestaandeWoning/WarmteVraag/alle;
// 			attribute<units/GJ_yr>   Vj_WarmtePrimairD                      := TussenResultaten/GebiedsAllocatie/Initieel/KostenBaten/Vj_WarmtePrimairD;
// 			attribute<units/GJ_yr>   WarmteVraagDeelnemers                  := TussenResultaten/GebiedsAllocatie/Initieel/KostenBaten/WarmteVraag/deelnemers;

// 			attribute<units/Percent> Eigendom_Koopwoningen                  := Geography/RegioIndelingen/buurt/Eigendom/p_koopw;
// 			attribute<units/Percent> Eigendom_Huurwoningen_totaal           := Geography/RegioIndelingen/buurt/Eigendom/p_huurw;
// 			attribute<units/Percent> Eigendom_In_bezit_woningcorporatie     := Geography/RegioIndelingen/buurt/Eigendom/p_wcorpw;
// 			attribute<units/Percent> Eigendom_In_bezit_overige_verhuurders  := Geography/RegioIndelingen/buurt/Eigendom/p_ov_hw;
// 			attribute<units/Percent> Eigendom_Eigendom_onbekend             := Geography/RegioIndelingen/buurt/Eigendom/p_e_o_w;
// 			attribute<units/Percent> Eigendom_p_checksum                    := Geography/RegioIndelingen/buurt/Eigendom/p_checksum;//eigen check
// 			attribute<units/Percent> Inkomen_Huishoudens_met_laag_inkomen   := Geography/RegioIndelingen/buurt/Inkomen/p_hh_li;
// 			attribute<units/Percent> Inkomen_Huishoudens_met_hoog_inkomen   := Geography/RegioIndelingen/buurt/Inkomen/p_hh_hi;
// 			attribute<units/Percent> Inkomen_Huishoudens_met_midden_inkomen := Geography/RegioIndelingen/buurt/Inkomen/p_hh_mi;//berekend veld uit andere velden
// 			attribute<units/Percent> Inkomen_p_checksum                     := Geography/RegioIndelingen/buurt/Inkomen/p_checksum;//eigen check

// 			attribute<units/GJ_yr> GebiedsOptie_totaal                      := /Resultaten/StartJaar/Metervraag/gebouwen/GebiedsOptie/totaal;
// 			attribute<units/GJ_yr> Aardgas_totaal                           := /Resultaten/StartJaar/Metervraag/gebouwen/Aardgas/totaal;
// 			attribute<units/GJ_yr> Elektriciteit_totaal                     := /Resultaten/StartJaar/Metervraag/gebouwen/Elektriciteit/totaal;
// 		}

// 		container export := Rapportage/WriteTableToCSV(table, SubItem_PropValues(table,'name'), FolderInfo/OutputFolder+'/PR.csv');
// 	}	
	
	Unit<UInt32>  table := Invoer/DefaultInstellingen/Basis/PlanRegio
	{
		//nrWEQ_HWU Aantal Woningequivalenten voor BestaandeWoning en BestaandeUtil
		attribute<nrWoningen>	nrWEQ_HWU:=
			sum( BebouwingsComponenten/BestaandeWoning/BebouwingsObject/nrWoonUnits_i ,
				BebouwingsComponenten/BestaandeWoning/PlanRegio_rel ) + 
			sum( BebouwingsComponenten/BestaandeUtil/BebouwingsObject/nrWoonUnits_i ,
				BebouwingsComponenten/BestaandeUtil/PlanRegio_rel );

		attribute<rdc_meter> geometry (poly) := Invoer/RuimtelijkeData/StudieGebied/buurt/Geometry;

		attribute<string>    BU_CODE             := Invoer/RuimtelijkeData/StudieGebied/buurt/BU_CODE;
		attribute<string>    BU_NAAM             := Invoer/RuimtelijkeData/StudieGebied/buurt/BU_NAAM;
		attribute<string>    WK_CODE             := Invoer/RuimtelijkeData/StudieGebied/buurt/WK_CODE;
		attribute<string>    WK_NAAM             := Invoer/RuimtelijkeData/StudieGebied/buurt/WK_NAAM;
		attribute<string>    GM_CODE             := Invoer/RuimtelijkeData/StudieGebied/buurt/GM_CODE;
		attribute<string>    GM_NAAM             := Invoer/RuimtelijkeData/StudieGebied/buurt/GM_NAAM;
		attribute<string>    ER_NAAM             := Invoer/RuimtelijkeData/StudieGebied/buurt/ER_NAAM;
		attribute<string>    PROV_NAAM           := Invoer/RuimtelijkeData/StudieGebied/buurt/PROV_NAAM;

		//in quotes naam Y:\Project\m500115_energie_duurzaam_ontwikkeling\Data\Project 2019\Leidraad\Visualisatie\20190722_Indicatoren.xlsx sheet Gemeenteraport
		//"2	Warmtevraag Totaal"
		attribute<GJ_yr_WEQ> MV_totaal           := div(sum(LeidraadExports/DataDump/BCResults/BestaandeWoning/Table/MV_totaal,BebouwingsComponenten/BestaandeWoning/PlanRegio_rel) + 
													    sum(LeidraadExports/DataDump/BCResults/BestaandeUtil/Table/MV_totaal,BebouwingsComponenten/BestaandeUtil/PlanRegio_rel), nrWEQ_HWU)[GJ_yr_WEQ];

		//"3	w.v. Aardgas"
		//"4	w.v. Hernieuwbaar gas"--> Mondelinge info Folckert is gewoon Aardgas

		attribute<GJ_yr_WEQ> MV_GAS              := div(InputOutput/totaal/Ongewogen/Verbruik/active_mut_tables/A1_GLevering/aggr_muts/a01_Gas_BestaandeWoning + 
													InputOutput/totaal/Ongewogen/Verbruik/active_mut_tables/A1_GLevering/aggr_muts/a21_Gas_BestaandeUtil, nrWEQ_HWU)[GJ_yr_WEQ];

		//"5	w.v. Elektrisch"
		attribute<GJ_yr_WEQ> MV_ELEK             := div(sum(LeidraadExports/DataDump/BCResults/BestaandeWoning/Table/MV_ELEK,BebouwingsComponenten/BestaandeWoning/PlanRegio_rel) + 
													    sum(LeidraadExports/DataDump/BCResults/BestaandeUtil/Table/MV_ELEK,BebouwingsComponenten/BestaandeUtil/PlanRegio_rel), nrWEQ_HWU)[GJ_yr_WEQ];

		//attribute<GJ_yr> MV_WarmteMT                        	:= sum(AllocatieResultaten/BestaandeWoning/AllocatieComponent/Metervraag/WarmteMT,PlanRegio_rel);
		// halen uit datadump tbv synchroon lopen
		
		//"6			w.v. MT warmtelevering"
		attribute<GJ_yr_WEQ> MV_WarmteMT         := div(sum(LeidraadExports/DataDump/BCResults/BestaandeWoning/Table/MV_WarmteMT,BebouwingsComponenten/BestaandeWoning/PlanRegio_rel) + 
													    sum(LeidraadExports/DataDump/BCResults/BestaandeUtil/Table/MV_WarmteMT,BebouwingsComponenten/BestaandeUtil/PlanRegio_rel), nrWEQ_HWU)[GJ_yr_WEQ];

		//"7			w.v. LT warmtelevering"
		attribute<GJ_yr_WEQ> MV_WarmteLT         := div(sum(LeidraadExports/DataDump/BCResults/BestaandeWoning/Table/MV_WarmteLT,BebouwingsComponenten/BestaandeWoning/PlanRegio_rel) + 
													   sum(LeidraadExports/DataDump/BCResults/BestaandeUtil/Table/MV_WarmteLT,BebouwingsComponenten/BestaandeUtil/PlanRegio_rel), nrWEQ_HWU)[GJ_yr_WEQ];
													   
		//"8	Warmtevraag per hectare"
		attribute<GJ_yr_ha> Warmtevraag_per_hectare := div(sum(LeidraadExports/DataDump/BCResults/BestaandeWoning/Table/MV_totaal,BebouwingsComponenten/BestaandeWoning/PlanRegio_rel) + 
													    sum(LeidraadExports/DataDump/BCResults/BestaandeUtil/Table/MV_totaal,BebouwingsComponenten/BestaandeUtil/PlanRegio_rel), Invoer/RuimtelijkeData/StudieGebied/buurt/AreaInHa)[GJ_yr_ha];//buurt zonder water?

		//"9	Elektriciteitsvraag"
		attribute<GJ_yr_WEQ> Elektriciteitsvraag := div(InputOutput/totaal/Ongewogen/Verbruik/mut_tables/C0_Apparatuur/aggr_muts/a02_Elektra_BestaandeWoning + 
													InputOutput/totaal/Ongewogen/Verbruik/mut_tables/C0_Apparatuur/aggr_muts/a22_Elektra_BestaandeUtil, nrWEQ_HWU)[GJ_yr_WEQ];

}
	container export_csv := Rapportage/WriteTableToCSV(table, SubItem_PropValues(table,'name'), FolderInfo/OutputFolder+'/PR.csv');
	//container export_fss := Rapportage/WriteTableToCSV(table, SubItem_PropValues(table,'name'), FolderInfo/OutputFolder+'/PR.fss');
	}
	
	container DataDump
	{
	container BCResults :=
		for_each_ne(Classifications/BebouwingsComponent/name,
			'DataDumpExportsBebouwingsComponent('+Quote(Classifications/BebouwingsComponent/name)+',Allocatie/'+Classifications/BebouwingsComponent/name+',BebouwingsComponenten/'+Classifications/BebouwingsComponent/name+')');

	parameter<String> GenerateAll := 'Ready', ExplicitSuppliers = 
		"='BCResults/'+Classifications/BebouwingsComponent/name+'/Table;'"
		"+AsList('BCResults/'+Classifications/BebouwingsComponent/name+'',';')";
	}
}